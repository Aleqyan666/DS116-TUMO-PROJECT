"0","library(lubridate)"
"0","library(dplyr)"
"0","library(tidyr)"
"0",""
"0","# each student's first seen month"
"0","student_first_seen <- merged_df %>%"
"0","  filter(!is.na(StartDate)) %>%"
"0","  mutate(StartDate = as.Date(StartDate, format = ""%d-%b-%y"")) %>%"
"0","  group_by(TumoID) %>%"
"0","  summarise(FirstMonth = format(min(StartDate), ""%b %Y""), .groups = ""drop"")"
"0",""
"0","# Tag new vs returning"
"0","student_type_tbl <- merged_df %>%"
"0","  filter(!is.na(StartDate)) %>%"
"0","  mutate("
"0","    StartDate = as.Date(StartDate, format = ""%d-%b-%y""),"
"0","    MonthYear = format(StartDate, ""%b %Y"")"
"0","  ) %>%"
"0","  left_join(student_first_seen, by = ""TumoID"") %>%"
"0","  mutate(StudentType = ifelse(MonthYear == FirstMonth, ""New"", ""Returning"")) %>%"
"0","  count(MonthYear, StudentType) %>%"
"0","  pivot_wider(names_from = StudentType, values_from = n, values_fill = 0) %>%"
"0","  column_to_rownames(""MonthYear"") %>%"
"0","  as.matrix()"
"0","chisq_result <- chisq.test(student_type_tbl)"
"0","chisq_result"
"1","
"
"1","	Pearson's Chi-squared test"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","student_type_tbl"
"1",""
"1","
"
"1","X-squared = 16917, df = 15, p-value < 2.2e-16"
"1","
"
"1","
"
"0","if (chisq_result$p.value < 0.05) {"
"0","  cat(""✅ H₁ is supported: Student type distribution (New vs Returning) varies significantly by month.\n"")"
"0","} else {"
"0","  cat(""❌ Fail to reject H₀: No significant difference in student type distribution across months.\n"")"
"0","}"
"1","✅ H₁ is supported: Student type distribution (New vs Returning) varies significantly by month.
"
