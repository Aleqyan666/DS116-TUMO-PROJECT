"0","student_first_seen <- merged_df %>%"
"0","  filter(!is.na(StartDate)) %>%"
"0","  mutate(StartDate = as.Date(StartDate, format = ""%d-%b-%y"")) %>%"
"0","  group_by(TumoID) %>%"
"0","  summarise(FirstMonth = format(min(StartDate), ""%b %Y""), .groups = ""drop"")"
"0",""
"0","first_vs_returning <- merged_df %>%"
"0","  filter(!is.na(StartDate), !is.na(TumoID)) %>%"
"0","  mutate(StartDate = as.Date(StartDate, format = ""%d-%b-%y""),"
"0","         MonthYear = format(StartDate, ""%b %Y"")) %>%"
"0","  left_join(student_first_seen, by = ""TumoID"") %>%"
"0","  mutate(StudentType = ifelse(MonthYear == FirstMonth, ""New"", ""Returning"")) %>%"
"0","  count(MonthYear, StudentType) %>%"
"0","  pivot_wider(names_from = StudentType, values_from = n, values_fill = 0) %>%"
"0","  mutate("
"0","    MonthYear = factor(MonthYear, levels = unique(format(sort(as.Date(paste0(""01 "", MonthYear), format = ""%d %b %Y"")), ""%b %Y"")))"
"0","  ) %>%"
"0","  pivot_longer(cols = c(""New"", ""Returning""), names_to = ""Type"", values_to = ""Count"")"
"0",""
"0","ggplot(first_vs_returning, aes(x = MonthYear, y = Count, fill = Type)) +"
"0","  geom_col(position = ""stack"") +"
"0","  scale_y_continuous("
"0","    breaks = seq(0, 6000, by = 1000),"
"0","    labels = scales::comma_format()"
"0","  ) +"
"0","  labs("
"0","    title = ""New vs Returning Students Over Time"","
"0","    x = ""Month"","
"0","    y = ""Number of Students"","
"0","    fill = ""Student Type"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1))"
"0",""
